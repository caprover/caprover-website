<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Service Update Override · CapRover</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="**Available as of v1.8.0**"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Service Update Override · CapRover"/><meta property="og:type" content="website"/><meta property="og:url" content="https://caprover.com/index.html"/><meta property="og:description" content="**Available as of v1.8.0**"/><meta property="og:image" content="https://caprover.com/img/logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://caprover.com/img/logo.png"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-132762521-1', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.png" alt="CapRover"/><h2 class="headerTitleWithLogo">CapRover</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/get-started.html" target="_self">Docs</a></li><li class=""><a href="https://github.com/caprover/caprover" target="_self">GitHub</a></li><li class=""><a href="https://join.slack.com/t/caprover/shared_invite/zt-2qlb28drp-RpxNfY3nUhroLuRJUUJzDA" target="_self">Slack Group</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Do More</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Basics</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/get-started.html">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/docs/cdd-migration.html">CaptainDuckDuck Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/captain-definition-file.html">Captain Definition File</a></li><li class="navListItem"><a class="navItem" href="/docs/deployment-methods.html">Deployment Methods</a></li><li class="navListItem"><a class="navItem" href="/docs/app-configuration.html">App Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/persistent-apps.html">Persistent Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/cli-commands.html">CLI Commands</a></li><li class="navListItem"><a class="navItem" href="/docs/one-click-apps.html">One-Click Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/complete-webapp-tutorial.html">Complete Webapp Tutorial</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Do More</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/resource-monitoring.html">Resource Monitoring</a></li><li class="navListItem"><a class="navItem" href="/docs/nginx-customization.html">NGINX Config</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/service-update-override.html">Service Update Override</a></li><li class="navListItem"><a class="navItem" href="/docs/app-scaling-and-cluster.html">App Scaling &amp; Cluster</a></li><li class="navListItem"><a class="navItem" href="/docs/pre-deploy-script.html">Pre-deploy Script</a></li><li class="navListItem"><a class="navItem" href="/docs/play-with-docker.html">Play with CapRover</a></li><li class="navListItem"><a class="navItem" href="/docs/run-locally.html">Run Locally</a></li><li class="navListItem"><a class="navItem" href="/docs/certbot-config.html">Certbot Overrides</a></li><li class="navListItem"><a class="navItem" href="/docs/theme-customization.html">Custom Themes</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Recipes and Tips</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/sample-apps.html">Sample Apps</a></li><li class="navListItem"><a class="navItem" href="/docs/zero-downtime.html">Zero Downtime</a></li><li class="navListItem"><a class="navItem" href="/docs/database-connection.html">Database Connection</a></li><li class="navListItem"><a class="navItem" href="/docs/best-practices.html">Best Practices</a></li><li class="navListItem"><a class="navItem" href="/docs/backup-and-restore.html">Backup &amp; Restore</a></li><li class="navListItem"><a class="navItem" href="/docs/recipe-deploy-create-react-app.html">Static React App</a></li><li class="navListItem"><a class="navItem" href="/docs/stateless-with-persistent-data.html">Stateless with Persistent data</a></li><li class="navListItem"><a class="navItem" href="/docs/docker-compose.html">Docker Compose</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">CI/CD Integration</h4><ul><li class="navListItem"><a class="navItem" href="/docs/ci-cd-integration.html">Intro</a></li><li class="navListItem"><a class="navItem" href="/docs/ci-cd-integration/deploy-from-github.html">Deploy from GitHub</a></li><li class="navListItem"><a class="navItem" href="/docs/ci-cd-integration/deploy-from-gitlab.html">Deploy from GitLab</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Help</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Server Purchase</h4><ul><li class="navListItem"><a class="navItem" href="/docs/server-purchase/digitalocean.html">DigitalOcean</a></li><li class="navListItem"><a class="navItem" href="/docs/server-purchase/openstack.html">OpenStack</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/disk-cleanup.html">Disk Clean-Up</a></li><li class="navListItem"><a class="navItem" href="/docs/firewall.html">Firewall &amp; Port Forwarding</a></li><li class="navListItem"><a class="navItem" href="/docs/troubleshooting.html">Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/docs/troubleshooting-pro.html">Troubleshooting (Pro)</a></li><li class="navListItem"><a class="navItem" href="/docs/support.html">Help and Support</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/caprover/caprover-website/edit/master/docs/service-update-override.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Service Update Override</h1></header><article><div><span><p><strong>Available as of v1.8.0</strong></p>
<p>Although <a href="/docs/pre-deploy-script.html">pre-deploy script</a> provides a great power for customization of the service, sometimes, it has too much power for what you need to do.</p>
<p>For example, Docker allows you to define read-only volumes, or UDP only port mapping, and many other customization flags through <a href="https://docs.docker.com/engine/reference/commandline/service_update/">docker update command</a>. Not all of these flags are ported over to CapRover as they are rarely used. Nevertheless, there are situations where you want to use some of these flags. For these cases, you can define a service override JSON or YAML content.</p>
<p>Every time you deploy a new version, or you change a configuration parameter in the app, your service goes through an update process:</p>
<ol>
<li>CapRover updates the fields that are explicitly set on CapRover UI (env vars, instance count and etc).</li>
<li>If &quot;Service Update Override&quot; is present, CapRover overrides the result from the previous step with the override content.</li>
<li>If &quot;Pre-deploy script&quot; is present, CapRover runs the pre-deploy script.</li>
<li>The result from the previous 3 steps is then passed to the Docker API so that Docker can update the service under the hood.</li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="schema"></a><a href="#schema" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Schema</h2>
<p>For the &quot;Service Update Override&quot;, you can use both yaml and JSON. The schema needs to match <a href="https://docs.docker.com/engine/api/v1.40/#operation/ServiceUpdate">Service Update Object</a> in Docker API. In YAML format, it'll be something like the following YAML. Note that this is just a partial example, there are many more customization parameter available.</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">TaskTemplate:</span>
  <span class="hljs-attr">ContainerSpec:</span>
    <span class="hljs-attr">Labels:</span>
      <span class="hljs-attr">some.label:</span> <span class="hljs-string">some.value</span>
    <span class="hljs-attr">Image:</span> <span class="hljs-string">busybox</span>
    <span class="hljs-attr">Command:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./mycommand.sh</span>
    <span class="hljs-attr">Hostname:</span> <span class="hljs-string">my.domain.com</span>
    <span class="hljs-attr">CapabilityAdd:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">CAP_NET_ADMIN</span>
    <span class="hljs-attr">DNSConfig:</span>
      <span class="hljs-attr">Nameservers:</span>
         <span class="hljs-bullet">-</span> <span class="hljs-number">8.8</span><span class="hljs-number">.8</span><span class="hljs-number">.8</span> 
         <span class="hljs-bullet">-</span> <span class="hljs-number">8.8</span><span class="hljs-number">.4</span><span class="hljs-number">.4</span> 
    <span class="hljs-attr">Mounts:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">Type:</span> <span class="hljs-string">bind</span>
        <span class="hljs-attr">Source:</span> <span class="hljs-string">/host/directory</span>
        <span class="hljs-attr">Target:</span> <span class="hljs-string">/some/path/in/container</span>
        <span class="hljs-attr">ReadOnly:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">Args:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">top</span>
  <span class="hljs-attr">Resources:</span>
    <span class="hljs-attr">Limits:</span>
      <span class="hljs-attr">MemoryBytes:</span> <span class="hljs-number">104857600</span>
      <span class="hljs-attr">NanoCPUs:</span> <span class="hljs-number">2000000000</span>
    <span class="hljs-attr">Reservations:</span>
      <span class="hljs-attr">MemoryBytes:</span> <span class="hljs-number">104857600</span>
      <span class="hljs-attr">NanoCPUs:</span> <span class="hljs-number">2000000000</span>
  <span class="hljs-attr">RestartPolicy:</span>
    <span class="hljs-attr">Condition:</span> <span class="hljs-string">any</span>
    <span class="hljs-attr">MaxAttempts:</span> <span class="hljs-number">0</span>
  <span class="hljs-attr">Placement:</span>
    <span class="hljs-attr">Constraints:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">node.id==2ivku8v2gvtg4</span>
  <span class="hljs-attr">Networks:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">Target:</span> <span class="hljs-string">captain-overlay-network</span>
  <span class="hljs-attr">LogDriver:</span>
    <span class="hljs-attr">Name:</span> <span class="hljs-string">json-file</span>
    <span class="hljs-attr">Options:</span>
      <span class="hljs-attr">max-size:</span> <span class="hljs-string">512m</span>
  <span class="hljs-attr">ForceUpdate:</span> <span class="hljs-number">0</span>
<span class="hljs-attr">Mode:</span>
  <span class="hljs-attr">Replicated:</span>
    <span class="hljs-attr">Replicas:</span> <span class="hljs-number">1</span>
<span class="hljs-attr">UpdateConfig:</span>
  <span class="hljs-attr">Parallelism:</span> <span class="hljs-number">2</span>
  <span class="hljs-attr">Delay:</span> <span class="hljs-number">1000000000</span>
  <span class="hljs-attr">FailureAction:</span> <span class="hljs-string">pause</span>
  <span class="hljs-attr">Monitor:</span> <span class="hljs-number">15000000000</span>
  <span class="hljs-attr">MaxFailureRatio:</span> <span class="hljs-number">0.15</span>
  <span class="hljs-attr">Order:</span> <span class="hljs-string">start-first</span>
<span class="hljs-attr">RollbackConfig:</span>
  <span class="hljs-attr">Parallelism:</span> <span class="hljs-number">1</span>
  <span class="hljs-attr">Delay:</span> <span class="hljs-number">1000000000</span>
  <span class="hljs-attr">FailureAction:</span> <span class="hljs-string">pause</span>
  <span class="hljs-attr">Monitor:</span> <span class="hljs-number">15000000000</span>
  <span class="hljs-attr">MaxFailureRatio:</span> <span class="hljs-number">0.15</span>
  <span class="hljs-attr">Order:</span> <span class="hljs-string">start-first</span>
<span class="hljs-attr">EndpointSpec:</span>
  <span class="hljs-attr">Mode:</span> <span class="hljs-string">vip</span>
  <span class="hljs-attr">Ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">Name:</span> <span class="hljs-string">something</span>
      <span class="hljs-attr">Protocol:</span> <span class="hljs-string">tcp</span>
      <span class="hljs-attr">TargetPort:</span> <span class="hljs-number">80</span>
      <span class="hljs-attr">PublishedPort:</span> <span class="hljs-number">8080</span>
      <span class="hljs-attr">PublishMode:</span> <span class="hljs-string">host</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="sample-use-cases"></a><a href="#sample-use-cases" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sample Use Cases</h2>
<p>One common use case is to limit the resource usage by a particular service. In that case, you can do something like:</p>
<pre><code class="hljs"><span class="hljs-attr">TaskTemplate:</span>
  <span class="hljs-attr">Resources:</span>
    <span class="hljs-attr">Limits:</span>
      <span class="hljs-attr">MemoryBytes:</span>  <span class="hljs-number">104857600</span>
      <span class="hljs-attr">NanoCPUs:</span> <span class="hljs-number">2000000000</span>
</code></pre>
<p>This will impose a limit of 2 CPUs and 100MB RAM usage on your service. You can confirm this by running</p>
<pre><code class="hljs">docker<span class="hljs-built_in"> service </span>inspect srv-captain--your-app-name --pretty
</code></pre>
<p>Another use case is when you want to customize the command:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">TaskTemplate:</span>
  <span class="hljs-attr">ContainerSpec:</span>
    <span class="hljs-attr">Command:</span> <span class="hljs-string">"./mycommand.sh"</span>
</code></pre>
<p>If your container need some CAP_ADD added to the docker service, you can go as follow:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">TaskTemplate:</span>
  <span class="hljs-attr">ContainerSpec:</span>
    <span class="hljs-attr">CapabilityAdd:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">CAP_SYS_ADMIN</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">CAP_NET_ADMIN</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="revert-to-default"></a><a href="#revert-to-default" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Revert to Default</h2>
<p>One important note is that CapRover does NOT modify any existing flags that it doesn't control. Flags that CapRover controls are: env vars, ports, image, and a few others.</p>
<p>If you override a property that is not controlled by CapRover, like the CPU limit in above, even if you delete the override, the config won't be reverted. This is because it has already been set in Docker engine.</p>
<p>So instead of removing the override, change the override to another value, and then remove it. For example, if you want to remove the limitation on CPU and RAM:</p>
<ul>
<li>First, set it to a high value, for example, RAM to 50GB and CPU to 20 CPUs</li>
<li>Then, you can remove the override.</li>
</ul>
<p>Of course, alternatively, you can delete the service and create a new one.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/nginx-customization.html"><span class="arrow-prev">← </span><span>NGINX Config</span></a><a class="docs-next button" href="/docs/app-scaling-and-cluster.html"><span>App Scaling &amp; Cluster</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#schema">Schema</a></li><li><a href="#sample-use-cases">Sample Use Cases</a></li><li><a href="#revert-to-default">Revert to Default</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/logo.png" alt="CapRover" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/get-started.html">Getting Started</a></div><div><h5>Community</h5><a href="https://twitter.com/cap_rover" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://join.slack.com/t/caprover/shared_invite/zt-2qlb28drp-RpxNfY3nUhroLuRJUUJzDA" target="_blank" rel="noreferrer noopener">Slack Group</a></div><div><h5>More</h5><a href="https://github.com/caprover/caprover" target="_blank">GitHub</a><a class="github-button" href="https://github.com/caprover/caprover" data-icon="octicon-star" data-count-href="/caprover/caprover/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2025 githubsaturn</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '81e546c2e0c9258e48c359465bde6909',
                indexName: 'caprover',
                inputSelector: '#search_input_react'
              });
            </script></body></html>